<!DOCTYPE html>
<!--[if lt IE 7]>
<html lang="zh-CN" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html lang="zh-CN" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html lang="zh-CN" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="zh-CN" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>
    <meta name="author" content="wangyali"/>
    <meta name="keywords" content=""> <!-- 关键词，搜索什么能看到 -->
    <meta name="description" content=""/> <!-- 内容描述 -->
    <meta name="theme-color" content="#861519">
    <meta name="msapplication-navbutton-color" content="#861519">
    <meta name="apple-mobile-web-app-status-bar-style" content="#861519">

    <title>和和影业</title>

    <!--CSS-->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/reset.css"/>
    <link rel="stylesheet" href="css/style.css"/>
    <link rel="stylesheet" href="css/films-detail.css"/>
    <link rel="shortcut icon" href="images/icon.png"/>
</head>
<body>

<!-- Navigation -->
<div id="my-nav">
	<my-nav></my-nav>
</div>

<div class="page-bak" style="background-image: url(images/films-cover-demo.jpg);">
	<!--<p class="news-title-en">SHANGXIA NEWS</p>-->
    <!--<p class="news-title-cn">山下新闻</p>-->
</div>

<div class="page" id="vue-page">
    <div class="film-info">
        <div class="film-info-left">
            <p>{{title}}</p>
            <img v-bind:src="poster">
            <a v-if="store" v-bind:href="store">
                <p>购买周边</p>
            </a>
        </div>
        <div class="film-info-right">
            <table>
            <tr v-if="director">
                <td>导演：</td>
                <td>{{director}}</td>
            </tr>
            <tr v-if="writer">
                <td>编剧：</td>
                <td>{{writer}}</td>
            </tr>
            <tr v-if="stars">
                <td>主演：</td>
                <td>{{stars}}</td>
            </tr>
            <tr v-if="release_date">
                <td>上映日期：</td>
                <td>{{release_date}}</td>
            </tr>
            <tr v-if="genre">
                <td>类型：</td>
                <td>{{genre}}</td>
            </tr>
            <tr v-if="lang">
                <td>语言：</td>
                <td>{{lang}}</td>
            </tr>
            <tr v-if="duration">
                <td>片长：</td>
                <td>{{duration}}分钟</td>
            </tr>
            <tr v-if="country">
                <td>制片地区：</td>
                <td>{{country}}</td>
            </tr>
            <tr v-if="release_vision">
                <td>版本：</td>
                <td>{{release_vision}}</td>
            </tr>
            <tr v-if="description">
                <td>故事梗概：</td>
                <td>{{description}}</td>
            </tr>
            </table>
        </div>
    </div>

    <div class="film-videos">
        <div class="film-videos-head">
            <hr>
            <p>预告片</p>
            <hr>
        </div>
        <div class="film-videos-preview-title">
            <p>{{currentPreviewTitle}}</p>
        </div>
        <div class="film-videos-preview">
            <div id="moviePreview" class="carousel slide" data-ride="carousel" data-wrap="false" data-interval="false">
                <div class="carousel-inner">
                    <div v-for="(video, index) of videos" v-bind:class="index==0?'item active':'item'">
                        <img v-bind:src="video.img">
                        <img class="play-icon" src="images/video-play.png">
                    </div>
                </div>

                <a v-bind:class="currentPreviewIndex==0?'disable':''" class="left carousel-control" href="#moviePreview" data-slide="prev">
                    <img src="../../static/hehe/images/arrow-left-hh.png">
                </a>
                <a v-bind:class="currentPreviewIndex==videos.length - 1?'disable':''" class="right carousel-control" href="#moviePreview" data-slide="next">
                    <img src="../../static/hehe/images/arrow-right-hh.png">
                </a>
            </div>
            <div id="movieThumbnail" class="carousel slide" data-ride="carousel" data-wrap="false" data-interval="false">
                <div class="carousel-inner">
                    <div v-for="n in Math.ceil(videos.length/3)" v-bind:class="n==1?'item active':'item'">
                        <div v-for="(video, index) of sliceVideos(n)" class="item-thumbnail" v-bind:class="index + (n-1)*3 == currentPreviewIndex?'selected':''" v-on:click="thumbnailClick(index + (n-1)*3)">
                            <img v-bind:src="video.img">
                            <p class="time">{{video.time}}</p>
                            <p class="title">{{video.title}}</p>
                        </div>
                    </div>
                </div>

                <div class="arrow">
                    <a v-bind:class="currentThumbnailIndex==0?'disable':''" class="left" href="#movieThumbnail" data-slide="prev">
                        <img src="images/films-thumbnail-left-active.png">
                    </a>
                    <a v-bind:class="currentThumbnailIndex==Math.floor(videos.length/3)?'disable':''" class="right" href="#movieThumbnail" data-slide="next">
                        <img src="images/films-thumbnail-right-active.png">
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Footer -->
<div id="my-footer">
    <my-footer></my-footer>
</div>

<!--JS-->
<script src="https://cdn.bootcss.com/vue/2.5.9/vue.min.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/axios/0.17.1/axios.min.js"></script>
<!-- <script type="text/javascript" src="js/films-detail.js"></script> -->
<script src="js/nav.js"></script>
<script>
    var vue = new Vue({
        el: '#vue-page',
        data: {
            title: "《西游2伏妖篇》",
            poster: "images/films-cover-demo.jpg",
            store: "https://www.taobao.com/",
            director: "徐克", //导演
            writer: "周星驰", //编剧
            release_date: "2017-01-01", //上映日期
            genre: "魔幻/喜剧", //类型
            duration: 120, //片长
            description: "作为《西游降魔篇》的后继故事，唐三藏在上集感化了杀死段小姐的齐天大圣，并收其为徒后，带着孙悟空、猪八戒及沙僧，一行\
人《西游降魔篇》的后继故事，唐三藏在上集感化了杀死段小姐的齐天大圣，并收其为徒后，带着孙悟空、猪八戒及沙僧，一行四\
踏上西天取经之旅，路途凶险，除魔伏妖，师徒四人并收其为徒后，带着孙悟空。", //简介
            stars: "吴亦凡 / 皮尔斯·布鲁斯南 / 欧拉·布拉迪 / 德莫·克劳利 / 吴亦凡 / 吴亦凡", //主演，演员
            clips: ["http://hh.com/1.jpg", "http://hh.com/2.jpg"], //剧照
            videos: [{
                title: "终极预告片1",
                time: "01:23",
                url: "",
                img: "images/img/001.jpg"
                },
                {
                title: "终极预告片2",
                time: "02:23",
                url: "",
                img: "images/img/002.jpg"
                },
                {
                title: "终极预告片3",
                time: "03:23",
                url: "",
                img: "images/img/003.jpg"
                },
                {
                title: "终极预告片4",
                time: "04:23",
                url: "",
                img: "images/img/004.jpg"
                },
                {
                title: "终极预告片5",
                time: "05:23",
                url: "",
                img: "images/img/005.jpg"
                },
            ], //宣传视频
            lang: "普通话", //语言
            release_vision: "2D/IMAX3D", //荧幕类型
            country: "中国大陆", //制作国家
            mknown: "小海怪/Mermaid", //又名
            currentPreviewTitle: "",
            currentPreviewIndex: 0,
            currentThumbnailIndex: 0,
        },
        created: function () {
            axios.get('http://staging.hehefilm.com/resources/movie/1')
            .then(resp => {
                console.log(resp.data);
            }).catch(err => {
                console.log('请求失败：'+err.status+','+err.statusText);
            });
        },
        mounted: function () {
            this.currentPreviewTitle = this.videos[0].title;
            document.title = '和和影业 - ' + this.title;
        },
        methods: {
            sliceVideos: function (n) {
                return this.videos.slice( (n-1)*3, n*3);
            },
            thumbnailClick: function(index) {
                this.currentPreviewTitle = this.videos[index].title;
                this.currentPreviewIndex = index;
                this.currentThumbnailIndex = Math.floor(index/3);
                if (lastSelectedThumbnailIndex != index) {
                    $("#moviePreview").carousel(index);
                    $("#movieThumbnail").carousel(Math.floor(index/3)); 
                    lastSelectedThumbnailIndex = index;
                }
            }
        }
    })

    var lastSelectedThumbnailIndex = 0;
	
    $('#movieThumbnail').on('slid.bs.carousel', function() {
        index = $('#movieThumbnail > .carousel-inner > div.active').index();
        vue.currentThumbnailIndex = index;
    });
    $('#moviePreview').on('slid.bs.carousel', function() {
        index = $('#moviePreview > .carousel-inner > div.active').index();
        vue.currentPreviewIndex = index;
        vue.currentThumbnailIndex = Math.floor(index/3);
        if (lastSelectedThumbnailIndex != index) {
            $("#movieThumbnail").carousel(Math.floor(index/3));
            lastSelectedThumbnailIndex = index;
        }
    });

    
</script>

</body>
</html>
